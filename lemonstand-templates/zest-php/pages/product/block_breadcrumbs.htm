<? $category = isset($product) ? $product->categories[0] : null ?>

<ul class="mybreadcrumbs">
  <li><a href="<?= root_url('/') ?>">Home</a></li>
  <li><a href="<?= root_url('/shop') ?>">Shop</a></li>
  <? if ($category): ?>
    <? foreach ($category->get_parents() as $parent): ?>
      <li><a href="<?= $parent->page_url('/category') ?>"><? h($parent->name) ?></a></li>
    <? endforeach ?>
    <li><a href="<?= $category->page_url('/category') ?>"><?= h($category->name) ?></a></li>
  <? endif ?>
  
  <? if ($product): ?>
    <li class="active"><a href="<? $product->page_url('/product') ?>"><?= h($product->name) ?></a></li>
  <? endif ?>
</ul>