<div class="row">
  <div class="content twelve columns">
    <?= open_form(array('data-ajax-handler'=>'shop:on_updateCustomerProfile', 'class'=>'custom')) ?>
      <div class="row">
        <?= flash_message() ?>
        <div class="six columns">
          <h3>Billing information</h3>
          <div class="row">
            <div class="six columns">
              <label for="first_name">First Name</label>
              <input name="first_name" id="first_name" type="text" class="text" value="<?= h($this->customer->first_name) ?>"/>
            </div>
            <div class="six columns">
              <label for="last_name">Last Name</label>
              <input name="last_name" id="last_name" type="text" class="text" value="<?= h($this->customer->last_name) ?>"/>
            </div>
          </div>
          
          <div class="row">
            <div class="six columns">
              <label for="email">E-mail Address</label>
              <input type="text" name="email" id="email" value="<?= h($this->customer->email) ?>" />
            </div>
            <div class="six columns">
              <label for="phone">Phone Number</label>
              <input type="text" name="phone" id="phone" value="<?= h($this->customer->phone) ?>"/>
            </div>
          </div>
          
          <label for="billing_address">Address</label>
          <textarea id="billing_address" name="billing_street_addr"><?= h($this->customer->billing_street_addr) ?></textarea>
          <div class="row">
            <div class="six columns">
              <label for="billing_city">City</label>
              <input type="text" name="billing_city" id="billing_city" value="<?= h($this->customer->billing_city) ?>"/>
            </div>
            <div class="six columns">
              <label for="billing_zip">Zip Code</label>
              <input type="text" id="billing_zip" name="billing_zip" value="<?= $this->customer->billing_zip ?>"/>
            </div>
          </div>
          <div class="row">
            <div class="six columns">
              <label for="billing_country">Country</label>
              <!-- 
                The state selector updates automatically when the country changes. 
                See app.js for the implementation details. 
              -->        
              <select id="billing_country" name="billing_country_id" data-state-selector="billing_state" data-current-state="<?= $this->customer->billing_state_id ?>">
                <? foreach ($countries as $country): ?>
                  <option <?= option_state($this->customer->billing_country_id, $country->id) ?> value="<?= $country->id ?>"><?= h($country->name) ?></option>
                <? endforeach ?>
              </select>
            </div>
            <div class="six columns">
              <label for="billing_state">State</label>
              <select id="billing_state" name="billing_state_id"> 
                <? $this->render_partial('shop:state_options', array('states'=>$states, 'current_state'=>$this->customer->billing_state_id)) ?>
              </select>
            </div>
          </div>
        </div>
        
        <div class="six columns">
          <h3>Shipping information</h3>
          
          <div class="row">
            <div class="six columns">
              <label for="shipping_first_name">First Name</label>
              <input type="text" name="shipping_first_name" id="shipping_first_name" value="<?= h($this->customer->shipping_first_name) ?>"/>
            </div>
            <div class="six columns">
              <label for="shipping_last_name">Last Name</label>
              <input type="text" name="shipping_last_name" id="shipping_last_name" value="<?= h($this->customer->shipping_last_name) ?>"/>
            </div>
          </div>
          <div class="row">
            <div class="twelve columns">
              <label for="shipping_phone">Phone Number</label>
              <input type="text" name="shipping_phone" id="shipping_phone" value="<?= h($this->customer->shipping_phone) ?>"/>
            </div>
          </div>
          
          <label for="shipping_address">Address</label>
          <textarea name="shipping_street_addr" id="shipping_address"><?= h($this->customer->shipping_street_addr) ?></textarea>
          <div class="row">
            <div class="six columns">
              <label for="shipping_city">City</label>
              <input type="text" name="shipping_city" id="shipping_city" value="<?= h($this->customer->shipping_city) ?>"/>
            </div>
            <div class="six columns">
              <label for="shipping_zip">Zip Code</label>
              <input type="text" name="shipping_zip" id="shipping_zip" value="<?= h($this->customer->shipping_zip) ?>"/>
            </div>
          </div>
          <div class="row">
            <div class="six columns">
              <label for="shipping_country">Country</label>
              <select id="shipping_country" name="shipping_country_id" data-state-selector="shipping_state" data-current-state="<? $this->customer->shipping_state_id ?>">
                <? foreach ($countries as $country): ?>
                  <option <?= option_state($this->customer->shipping_country_id, $country->id) ?> value="<?= $country->id ?>"><?= h($country->name) ?></option>
                <? endforeach ?>
              </select>
            </div>
            <div class="six columns">
              <label for="shipping_state">State</label>
              <select id="shipping_state" name="shipping_state_id"> 
                <? $this->render_partial('shop:state_options', array('states'=>$shipping_states, 'current_state'=>$this->customer->shipping_state_id)) ?>
              </select>
            </div>
          </div>
        </div>        
      </div>
      
      <div class="row">
        <div class="tvelwe columns">
          <input type="submit" class="button" value="Save"/>          
          <input type="hidden" name="flash" value="Your profile has been successfully updated."/>
          <input type="hidden" name="redirect" value="<?= root_url('/profile') ?>"/>
        </div>
      </div>
    <?= close_form() ?>
    
    <div class="row">
      <?= open_form(array('data-ajax-handler'=>'shop:on_changePassword', 'class'=>'custom')) ?>
        <div class="six columns">
          <h3>Change password</h3>
          <label for="old_password">Old password</label>
          <input name="old_password" id="old_password" type="password" class="text" value=""/>

          <div class="row">
            <div class="six columns">
              <label for="last_name">New password</label>
              <input name="password" id="password" type="password" class="text" value=""/>
            </div>
            
            <div class="six columns">
              <label for="password_confirm">Password confirmation</label>
              <input name="password_confirm" id="password_confirm" type="password" class="text" value=""/>
            </div>
          </div>
          
          <input type="submit" class="button" value="Save"/>          
          <input type="hidden" name="flash" value="Your password has been successfully changed."/>
          <input type="hidden" name="redirect" value="<?= root_url('/profile') ?>"/>
        </div>
      <?= close_form() ?>
    </div>
  </div>
</div>